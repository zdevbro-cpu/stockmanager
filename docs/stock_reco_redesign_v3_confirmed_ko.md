# 주식종목추천(코스피/코스닥) + 단기 타이밍 + VC급 리포트(비상장 포함) 재설계 v3
작성일: 2026-01-08 (KST)

본 문서는 사용자께서 확정해주신 방향을 “제품 요구사항(결정 사항)”으로 반영하고, 그에 맞춰 **아키텍처/데이터/퀀트/리포트**를 디테일하게 재정렬한 버전입니다.

---

## 1. 확정된 제품 방향(결정 사항)

### 1) 대상 시장
- 기본: **국내 주식(코스피/코스닥)**
- 확장: **ETF/리츠는 구조적으로 확장 가능하도록 설계** (초기에는 유니버스에서 제외 가능)

### 2) 운용 지평
- **단기 중심(일~주)**  
  - 추천(스크리닝)은 주/월 단위로 후보군 유지 가능  
  - **타이밍/신호는 일~분 단위**(가능 범위에서)로 설계

### 3) 추천 결과
- **Top N + 비중(weight)까지 산출**
- 비중은 “점수 기반 + 리스크 제약”으로 자동 산출(설명 가능해야 함)

### 4) 실행(주문)
- 시스템은 **신호만 제공**,  
- **실주문은 사용자가 수동으로 진행** (법/인가 리스크 최소화)

### 5) VC 리포트 대상
- **상장 + 비상장 포함**
- 비상장은 DART 중심이 불가능하므로 **데이터 수집 방식(입력/연동/검증)을 별도 설계**해야 함

---

## 2. 제품을 3개 출력물(Output)로 고정(변하지 않는 중심축)

### Output A. 종목추천(Top N + 비중)
- 코스피/코스닥 유니버스에서 **퀀트 점수 기반 Top N** 산출
- 각 종목의 목표 비중(weight)과 근거(팩터 기여, 리스크, 제약 충족)를 함께 제공

### Output B. 관심종목 타이밍 신호(일~주)
- 사용자가 선택한 관심종목(또는 추천 종목)에 대해
- `BUY / WAIT / REDUCE / SELL` + 트리거 조건 + 신뢰도 + 리스크 플래그 제공
- 알림(푸시/메일/슬랙 등)은 운영 옵션

### Output C. 투자심사 보고서(상장+비상장)
- 상장: DART+시장데이터 기반 “투자 메모(Investment Memo)” 자동 생성
- 비상장: 업로드/입력/외부DB(선택) 기반 “투자 메모” 자동 생성
- 정량(코드 계산) + 정성(LLM 서술) + 근거/인용(가능한 경우)을 결합

---

## 3. 전체 아키텍처(단기·수동주문·VC리포트에 맞춘 형태)

### 3.1 레이어
1) Ingestion (KRX/DART/ECOS/KIS + 비상장 입력/업로드)
2) Raw Store (원본 저장: JSON/CSV/PDF/엑셀/피치덱)
3) Staging/ODS (정규화 테이블)
4) Feature Store (시점 정합 + 피처 버전)
5) Engines
   - 추천 엔진(랭킹+비중)
   - 타이밍 엔진(진입/청산/리스크)
   - 리포트 엔진(상장/비상장 템플릿)
6) API (조회/검색/리포트/전략관리)
7) UI (스크리너/종목 상세/관심목록/리포트 빌더)
8) Observability (감사로그/재현성/데이터 품질)

### 3.2 저장소 권장
- Cloud SQL(PostgreSQL): 정규화 데이터, 피처, 전략, 결과, 리포트 메타
- Storage(GCS/Firebase): 공시원문, 비상장 자료(PDF/엑셀/피치덱), 리포트 산출물(PDF)
- (선택) Vector DB: 공시/비상장 문서 RAG(근거 기반 서술)

---

## 4. 데이터 설계(상장 vs 비상장 분기)

### 4.1 공통 “엔티티” 기준
- 상장: `ticker(stock_code)` 중심 + `corp_code` 매핑
- 비상장: `company_id` 중심(내부키) + 외부 식별자(사업자번호 등)는 **암호화/마스킹 정책** 필요

### 4.2 상장 데이터(코스피/코스닥)
- 시장: 가격/거래량(일봉), (선택) 분봉, 호가/체결
- 공시/재무: DART 공시, 재무제표(발표일 기준)
- 거시: ECOS 주요 시계열(금리/물가/환율 등)
- 수급/지수/기타: KRX 범위 내 통계(가능한 항목만)

### 4.3 비상장 데이터(핵심: “수집 방식”이 곧 제품 경쟁력)
비상장은 공시·시장가격이 없으므로, 시스템이 아래 입력을 수용해야 합니다.

**(1) 구조화 입력(폼)**
- 기업개요: 업종, 제품/서비스, 고객군, 경쟁사
- 재무(연도/분기): 매출, 매출총이익, 영업이익, 당기순이익, 현금흐름(가능한 범위)
- 지표: GM%, OPM%, 성장률, CAC/LTV(가능 시)
- 자본구조: 투자 라운드, 밸류, 희석, 캡테이블(선택)

**(2) 파일 업로드**
- 피치덱(PDF), IR 자료, 감사보고서/재무제표(엑셀), 계약서/주요 고객 증빙(선택)
- 업로드 파일은 원본 보관 + 추출 텍스트(검색/RAG용) 생성

**(3) 외부 데이터베이스 연동(선택)**
- 국내 기업정보/재무 데이터 제공 서비스(유료) 연동 가능하도록 “커넥터 인터페이스”만 설계
  - 초기 MVP에서는 연동 없이도 동작(입력/업로드 중심)

---

## 5. 퀀트 추천 엔진(단기 중심 + 비중 산출)

### 5.1 추천 엔진의 역할(중요)
- 추천은 “실행”이 아니라 **후보군을 체계적으로 뽑는 단계**
- 단기 운용이라도 **리스크/유동성/턴오버**가 성과를 좌우 → 제약조건이 핵심 디테일

### 5.2 기본 추천 파이프라인(권장)
1) Universe 필터(코스피/코스닥)
2) 팩터/피처 계산(설명 가능)
3) 점수 결합(가중치) → 랭킹
4) Top N 선택
5) 비중 산출(제약 포함)
6) 추천 근거 생성(팩터 기여도/리스크/필터 통과 사유)

### 5.3 단기 중심 피처 세트(예시)
- 모멘텀/추세:
  - 5/10/20일 수익률, 20일 돌파, 이동평균(20/60)
- 변동성/리스크:
  - 10/20일 변동성, ATR(선택), 최대낙폭(lookback)
- 유동성:
  - 거래대금(최근 20일 평균), 스프레드 근사(가능 시)
- 이벤트/필터(DART):
  - 실적 발표/정정/유증/감사 관련 이벤트 전후 필터(정책)

> 가치/퀄리티는 단기 타이밍에는 직접효과가 약할 수 있으나, “후보군 질”을 올리는 보조팩터로 사용 가능합니다(단, 발표일 정합 필수).

### 5.4 비중(weight) 산출(설명 가능한 방식 우선)
권장 기본:
- **Score-proportional + 리스크 패널티**
- 제약조건:
  - 종목 최대비중(예: 10%)
  - 섹터 최대비중(예: 25%)
  - 유동성 한도(일평균 거래대금 대비 주문 비율 제한)
  - 턴오버 제한(리밸런싱 시 과도한 교체 방지)

대안:
- 변동성 타겟팅: 변동성이 큰 종목 비중 축소
- 간단 리스크 패리티 응용(종목 단위)

### 5.5 전략 정의 JSON(필수: 버전관리)
- `universe_rules`
- `features`
- `scoring_weights`
- `constraints`
- `rebalance_schedule`
- `cost_model_assumptions`
- `explainability`(근거 생성 규칙)

---

## 6. 타이밍 엔진(신호만 제공, 단기 최적화)

### 6.1 신호 구조(표준)
- `signal`: BUY / WAIT / REDUCE / SELL
- `confidence`: 0~1
- `horizon`: 1d / 3d / 1w 등
- `triggers`: 조건 리스트(가격/변동성/이벤트)
- `risk_flags`: 거래정지, 변동성 급등, 이벤트 리스크 등

### 6.2 단기 타이밍 룰(예시 템플릿)
- 진입(매수) 예:
  - `close > max(close, 20d)` AND `volatility_z < 2`
  - `close > MA20` AND `MA20 상승`
- 대기(WAIT) 예:
  - `volatility_z >= 2` (급변 구간)
  - `중요 공시 전후 N일` (정책)
- 축소/청산 예:
  - `close < MA20` 또는 `trailing_stop hit`
  - `MDD > threshold`

> 본 설계는 수동주문이므로, 신호는 “행동 권고”와 “근거”를 명확히 제시하는 UX가 중요합니다.

---

## 7. VC/투자심사 리포트 엔진(상장 + 비상장)

### 7.1 리포트 공통 템플릿(권장)
1) Executive Summary
2) Business & Moat
3) Market/TAM & 경쟁환경
4) Financial Deep Dive
5) Valuation (상장: 멀티플/DCF, 비상장: 라운드/멀티플/시나리오 중심)
6) Catalysts & Risks
7) Scenario(베어/베이스/불) + 감도분석
8) Appendix(근거/자료 목록)

### 7.2 상장 리포트(근거: 공시/재무/시장)
- DART 공시/재무를 자동 수집·정규화
- 발표일 기준으로 성장률/마진/현금흐름 추세 계산
- 공시 타임라인과 리스크 이벤트 자동 요약(인용 가능)

### 7.3 비상장 리포트(근거: 입력/업로드/검증)
- 사용자가 입력한 재무 + 업로드 문서에서 추출한 근거를 결합
- “자료 신뢰도 레벨”을 명시:
  - (A) 감사보고서 기반
  - (B) 내부 결산/추정
  - (C) 피치덱 주장(검증 필요)
- 캡테이블/희석/라운드 히스토리(가능 시) 포함
- KPI가 있는 경우(SaaS, 커머스 등) 템플릿별 확장

### 7.4 RAG(근거 기반 서술) 적용 범위
- 상장: 공시 원문(사업보고서/분기보고서/주요사항) 중심
- 비상장: 피치덱/IR/재무 엑셀/계약 증빙 중심
- 산출물에는 “인용/근거 링크/파일 참조”를 남김(감사/검토 용)

---

## 8. 데이터/모델 품질 장치(디테일 확보)

### 8.1 필수 품질 규칙
- point-in-time 강제(발표일 이전 사용 금지)
- 유니버스/필터/전략/결과는 모두 버전으로 재현 가능해야 함
- 비용/슬리피지 가정은 전략 정의에 포함(비교 가능)

### 8.2 단기 전략 검증(권장)
- 워크포워드(rolling) + 거래비용 반영
- 회전율(턴오버) 제한 없이 성과가 좋은 전략은 의심(현실 체결 문제)
- 스트레스 테스트(변동성 급등 구간 별도 평가)

---

## 9. UI/기능 구성(결정 사항 반영)

### 9.1 Screener(추천)
- 필터(시장/유동성/섹터) + Top N + 비중
- 추천 근거: 점수/팩터 기여/리스크/제약 충족 여부

### 9.2 종목 상세(상장)
- 가격/추세/변동성 + 공시 타임라인 + 재무 요약
- 타이밍 신호(트리거 포함) + “수동 주문 체크리스트”

### 9.3 관심종목(Watchlist)
- 신호 알림 + 시뮬레이션(가상 진입/청산 성과)
- 사용자 정의 룰(간단한 트리거 커스텀)

### 9.4 리포트(상장/비상장)
- 템플릿 선택 → 자료 연결(공시/업로드/입력) → 자동 생성 → 검토/수정 → PDF 저장

---

## 10. 로드맵(결정 사항에 맞춘 현실적 단계)

### Phase 0: 공통 기반(데이터/버전관리)
- 상장: 종목마스터/일봉/기본지수
- DART 기본 적재(공시 메타 + 재무)
- ECOS 핵심 시계열
- 전략 정의 JSON v2 + 결과/리포트 버전관리

### Phase 1: 단기 추천(Top N + 비중) MVP
- 단기 피처 + 랭킹 + 제약 비중 산출
- 추천 근거 패널/리포트(간단) 제공

### Phase 2: 타이밍 신호 MVP(수동 주문)
- 추세/변동성/이벤트 기반 신호
- 관심종목 알림 + 시뮬레이션

### Phase 3: VC 리포트 MVP(상장 먼저)
- 상장 투자메모 자동생성 + 공시 근거 인용

### Phase 4: 비상장 리포트 확장
- 입력폼/업로드 + 신뢰도 레벨 + KPI 템플릿 확장
- (선택) 외부DB 커넥터 인터페이스 도입

---

## 11. 다음 설계 산출물(원하시면 바로 생성)
사용자 결정 사항이 확정되었으므로, 다음 3개를 “파일로” 만들어 드릴 수 있습니다.

1) **전략 정의 JSON 스키마 v2.1**  
   - 추천(Top N + 비중) + 타이밍 + 리포트 설정까지 포함

2) **PostgreSQL ERD 초안(v2.1)**  
   - 상장/비상장 분기 테이블 + 문서 업로드/RAG 인덱싱 테이블 포함

3) **API(OpenAPI) 초안(v2.1)**  
   - Screener/Signals/Watchlist/Reports/Strategies/Backtests 전부

---

## 12. 최소로 추가로 필요한 정보(정확도 상승용, 필수는 아님)
- 단기 타이밍의 기본 주기: 일봉 기준(장마감)만? 분봉(장중)까지?  
- 추천 Top N 기본값: 10/20/50 중 선호  
- 비상장 리포트 템플릿: SaaS/제조/커머스 등 “주력 섹터”가 있으신지

(위 3개는 없어도 진행 가능하며, 기본값으로 설계해도 됩니다.)
